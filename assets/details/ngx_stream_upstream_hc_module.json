[
[4,"health_check","Enables periodic health checks of the servers in a [group](https://nginx.org/en/docs/stream/ngx_stream_upstream_module.html#upstream).","<p>Enables periodic health checks of the servers in a <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_module.html#upstream\">group</a>.</p><p>The following optional parameters are supported:</p><dl class=\"compact\"><dt id=\"health_check_interval\"><code>interval</code>=<code>time</code></dt><dd>sets the interval between two consecutive health checks, by default, 5 seconds.</dd><dt id=\"health_check_jitter\"><code>jitter</code>=<code>time</code></dt><dd>sets the time within which each health check will be randomly delayed, by default, there is no delay.</dd><dt id=\"health_check_fails\"><code>fails</code>=<code>number</code></dt><dd>sets the number of consecutive failed health checks of a particular server after which this server will be considered unhealthy, by default, 1.</dd><dt id=\"health_check_passes\"><code>passes</code>=<code>number</code></dt><dd>sets the number of consecutive passed health checks of a particular server after which the server will be considered healthy, by default, 1.</dd><dt id=\"health_check_mandatory\"><code>mandatory</code> [<code>persistent</code>]</dt><dd><p>sets the initial “checking” state for a server until the first health check is completed (1.11.7). Client connections are not passed to servers in the “checking” state. If the parameter is not specified, the server will be initially considered healthy.</p><a name=\"health_check_persistent\"></a><p>The <code>persistent</code> parameter (1.21.1) sets the initial “up” state for a server after reload if the server was considered healthy before reload.</p></dd><dt id=\"health_check_match\"><code>match</code>=<code>name</code></dt><dd>specifies the <code>match</code> block configuring the tests that a successful connection should pass in order for a health check to pass. By default, for TCP, only the ability to establish a TCP connection with the server is checked. For <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_hc_module.html#health_check_udp\">UDP</a>, the absence of ICMP “<code>Destination Unreachable</code>” message is expected in reply to the sent string “<code>nginx health check</code>”.<blockquote class=\"note\">Prior to version 1.11.7, by default, UDP health check required a <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_hc_module.html#hc_match\">match</a> block with the <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_hc_module.html#match_send\">send</a> and <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_hc_module.html#match_expect\">expect</a> parameters.</blockquote></dd><dt id=\"health_check_port\"><code>port</code>=<code>number</code></dt><dd>defines the port used when connecting to a server to perform a health check (1.9.7). By default, equals the <a href=\"https://nginx.org/en/docs/stream/ngx_stream_upstream_module.html#server\">server</a> port.</dd><dt id=\"health_check_udp\"><code>udp</code></dt><dd>specifies that the <code>UDP</code> protocol should be used for health checks instead of the default <code>TCP</code> protocol (1.9.13).</dd></dl>",[],"<table ><tbody><tr><th>Syntax:</th><td><code><strong>health_check</strong> [<code>parameters</code>];</code><br></td></tr><tr><th>Default:</th><td>—</td></tr><tr><th>Context:</th><td><code>server</code><br></td></tr></tbody></table>"],
[4,"health_check_timeout","Overrides the [proxy\\_timeout](https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html#proxy_timeout) value for health checks.","<p>Overrides the <a href=\"https://nginx.org/en/docs/stream/ngx_stream_proxy_module.html#proxy_timeout\">proxy_timeout</a> value for health checks.</p>",[],"<table ><tbody><tr><th>Syntax:</th><td><code><strong>health_check_timeout</strong> <code>timeout</code>;</code><br></td></tr><tr><th>Default:</th><td><pre>health_check_timeout 5s;</pre></td></tr><tr><th>Context:</th><td><code>stream</code>, <code>server</code><br></td></tr></tbody></table>"],
[4,"match","Defines the named test set used to verify server responses to health checks.","<p>Defines the named test set used to verify server responses to health checks.</p><p>The following parameters can be configured:</p><dl class=\"compact\"><dt id=\"match_send\"><code>send</code> <code>string</code>;</dt><dd>sends a <code>string</code> to the server;</dd><dt id=\"match_expect\"><code>expect</code> <code>string</code> | <code>~</code> <code>regex</code>;</dt><dd>a literal string (1.9.12) or a regular expression that the data obtained from the server should match. The regular expression is specified with the preceding “<code>~*</code>” modifier (for case-insensitive matching), or the “<code>~</code>” modifier (for case-sensitive matching).</dd></dl><p>Both <code>send</code> and <code>expect</code> parameters can contain hexadecimal literals with the prefix “<code>\\x</code>” followed by two hex digits, for example, “<code>\\x80</code>” (1.9.12).</p><p>Health check is passed if:</p>",[],"<table ><tbody><tr><th>Syntax:</th><td><code><strong>match</strong> <code>name</code> { ... }</code><br></td></tr><tr><th>Default:</th><td>—</td></tr><tr><th>Context:</th><td><code>stream</code><br></td></tr></tbody></table>"]
]